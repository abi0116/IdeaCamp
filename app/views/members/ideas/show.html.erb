<div class = "container">
  <div class = "row">
    <div class = "col-md-9 mx-auto mt-3">
      <h1>アイディア詳細</h1>
      <table class = "table table-borderless border-bottom border-dark">
        <tr>
          <td style="width: 25%">
            <strong>アイディア名</strong><br>
            <%= @idea.title %><br><br>
            <strong>ジャンル</strong><br>
            <%= @idea.genre.name %><br><br>
            <strong>タグ</strong><br>
            <%= @idea.tag_list %><br>
            <strong>作成日</strong><br>
            <%= @idea.created_at.strftime("%Y/%m/%d %H:%M") %><br><br>
            <% if @idea.favorited_by?(current_member) %>
              <p>
                <%= link_to idea_favorites_path(@idea.id),method: :delete do %>
                  ♥<%= @idea.favorites.count %>
                <% end %>
              </p>
            <% else %>
              <p>
                <%= link_to idea_favorites_path(@idea.id),method: :post do %>
                  ♡<%= @idea.favorites.count %>
                <% end %>
              </p>
            <% end %>
            <% if @idea.member == current_member %>
              <%= link_to "編集",edit_idea_path(@idea.id) %>
              <%= link_to "削除",idea_path(@idea.id),method: :delete,data: {confirm: "削除しますか？"} %>
            <% end %>
          </td>
          <td style="width: 30%">
            <strong>写真、画像</strong><br>
            <%= attachment_image_tag @idea,:image,:fill,350,300,format: "jpg",follback: "no_image.jpg" %>
          </td>
          <td style="width: 45%">
            <strong>説明</strong><br>
            <%= @idea.caption %>
          </td>
        </tr>
      </table>
      <h4>コメント</h4>
      <div class = "row mb-4">
        <div class = "new-comments col-md-5" >
          <p>コメント件数:<%= @idea.idea_comments.count %></p>
          <%= form_with(model:[@idea,@idea_comment],local: true) do |f| %>
            <%= f.text_area :comment,row:"15",placeholder: "コメント記入欄" %>
            <%= f.submit "送信する" %>
          <% end %>
        </div>
        <div class = "comment-log col-md-7 mb-4">
          <table class = "table" >
            <% @idea.idea_comments.each do |idea_comment| %>
              <tr>
                <td>
                <%= idea_comment.member.last_name + idea_comment.member.first_name %><br>
                メンバーid:<%= idea_comment.member.id %>
                </td>
                <td>
                <%= idea_comment.comment %><br>
                <%= idea_comment.created_at.strftime("%Y/%m/%d %H:%M") %>
                </td>

                <td>
                  <% if idea_comment.member == current_member %>
                    <div class = "comment-delete" >
                      <%= link_to "削除",idea_idea_comment_path(idea_comment.idea,idea_comment),method: :delete,data: {confirm: "削除しますか？"} %>
                    </div>
                  <% end %>
                </td>
              </tr>
            <% end %>
          </table>
        </div>
      </div>
    </div>
  </div>
</div>
